<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-优雅的python深度学习" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/02/08/%E4%BC%98%E9%9B%85%E7%9A%84python%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="article-date">
  <time class="dt-published" datetime="2023-02-08T10:58:15.000Z" itemprop="datePublished">2023-02-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/02/08/%E4%BC%98%E9%9B%85%E7%9A%84python%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">优雅的python深度学习</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="根目录下"><a href="#根目录下" class="headerlink" title="根目录下"></a>根目录下</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">conf</span><br><span class="line">    train.yaml</span><br><span class="line">    test.yaml</span><br><span class="line">data</span><br><span class="line">    __init__.py           //最外层 get_dataset（dataset_name)</span><br><span class="line">    datasets.py           //各种个样dataset（paired unpaired combaind..)</span><br><span class="line">    transform.py          //制作dataset的时候，用到的数据变化 比如norm crop等</span><br><span class="line">    utils.py              //读取 加载 图片类型转化 padding等data用到的工具</span><br><span class="line"></span><br><span class="line">model</span><br><span class="line">    vgg19.weight</span><br><span class="line"></span><br><span class="line">models</span><br><span class="line">    auxiliary.py          //作为特征提取或者vggloss 辅助网络</span><br><span class="line">    discriminators.py     //组成鉴别器的不同组件 以及不同鉴别器</span><br><span class="line">    generators.py         //组成生成器的不同组件 以及不同生成器</span><br><span class="line">    losses.py             //比较复杂的loss 例如GAN perceptual loss</span><br><span class="line">    engan.py              //实验的完整网络和对比网络 由G和D和loss共同构成</span><br><span class="line">    utils.py              //初始化网络 初始化权重等 models部分用到的工具</span><br><span class="line">outputs</span><br><span class="line">    实验输出</span><br><span class="line">utils</span><br><span class="line">    metrics.py            //一些评价指标</span><br><span class="line">    utils.py              //系统时间啊 get device啊</span><br><span class="line">    visualize.py          //图片可视化和保存 </span><br><span class="line"></span><br><span class="line">eval.py</span><br><span class="line">train.py</span><br><span class="line">test.py</span><br><span class="line">README.md</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/02/08/%E4%BC%98%E9%9B%85%E7%9A%84python%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" data-id="cldvla5cj0000n7fb1mctg6w2" data-title="优雅的python深度学习" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Hydra使用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/02/08/Hydra%E4%BD%BF%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2023-02-08T03:04:39.000Z" itemprop="datePublished">2023-02-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/02/08/Hydra%E4%BD%BF%E7%94%A8/">Hydra使用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="最简单使用"><a href="#最简单使用" class="headerlink" title="最简单使用"></a>最简单使用</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install hydra-core</span><br></pre></td></tr></table></figure>

<h4 id="初步测试"><a href="#初步测试" class="headerlink" title="初步测试"></a>初步测试</h4><p>目前的代码结构</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">folder</span><br><span class="line">├── conf</span><br><span class="line">│   └── recoro_train.yaml</span><br><span class="line">└── main.py</span><br></pre></td></tr></table></figure>

<p>其中main.py </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from omegaconf import DictConfig, OmegaConf</span><br><span class="line">import hydra</span><br><span class="line"></span><br><span class="line">@hydra.main(config_path=&quot;./conf&quot;, config_name=&quot;recoro_train&quot;)</span><br><span class="line">def main(cfg: DictConfig):</span><br><span class="line">    running_dir = str(hydra.utils.get_original_cwd())</span><br><span class="line">    working_dir = str(Path.cwd())</span><br><span class="line">    print(f&quot;The current running directory is &#123;running_dir&#125;&quot;)</span><br><span class="line">    print(f&quot;The current working directory is &#123;working_dir&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The current running directory is C:\Users\xx\xx\xx\folder\</span><br><span class="line">The current working directory is C:\Users\xx\xx\xx\folder\outputs\2023-02-08\22-47-06</span><br></pre></td></tr></table></figure>

<p>可以看到hydra运行时，会自动建立一个输出文件夹，包含日期和时间信息，然后还会直接将路径调到里面去，以方便保存脚本内的各种东西。这就是初步测试，全部都在这一行：配置的路径在”conf”，配置的文件名为”recoro_train”</p>
<p>因此，无论在代码的任何地方，新建文件都会在working directory下 进行新建写入。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39537898/article/details/122162896#:~:text=%E4%B8%BB%E8%A6%81%E6%98%AF%E4%BB%8B%E7%BB%8Dpython%20hydra,%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%A6%86%E7%9B%96%E5%AE%83**%E3%80%82">【Python】Hydra 库使用记录_Kin__Zhang的博客-CSDN博客_python hydra</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/02/08/Hydra%E4%BD%BF%E7%94%A8/" data-id="cldvhmuxo0000n7fb9d0cdr25" data-title="Hydra使用" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hydra/" rel="tag">Hydra</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-python常用指令" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/01/11/python%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/" class="article-date">
  <time class="dt-published" datetime="2023-01-11T03:10:28.000Z" itemprop="datePublished">2023-01-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/01/11/python%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/">python常用指令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="查看pytorch版本"><a href="#查看pytorch版本" class="headerlink" title="查看pytorch版本"></a>查看pytorch版本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import torch</span><br><span class="line">print(torch.__version__)</span><br></pre></td></tr></table></figure>

<h4 id="python-文件管理"><a href="#python-文件管理" class="headerlink" title="python 文件管理"></a>python 文件管理</h4><h5 id="文件列表"><a href="#文件列表" class="headerlink" title="文件列表"></a>文件列表</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">filefolder = os.listdir(root)</span><br><span class="line">filefolder.sort()</span><br><span class="line">for f in filefolder:</span><br><span class="line">    print(f)</span><br></pre></td></tr></table></figure>

<h5 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import shutil</span><br><span class="line"></span><br><span class="line">os.remove(path) #删除文件</span><br><span class="line">os.removedirs(path) #删除空文件夹</span><br><span class="line"></span><br><span class="line">os.rmdir(path) #删除空文件夹</span><br><span class="line">shutil.rmtree(path) #递归删除文件夹，即：删除非空文件夹</span><br></pre></td></tr></table></figure>

<h5 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">with open(&#x27;./loss.txt&#x27;,&#x27;a+&#x27;) as f:   </span><br><span class="line">     for key in losssum:</span><br><span class="line">         f.write(f&quot;test_img : losses &#123;key&#125;: &#123;losssum[key]/items&#125;\n&quot;)  </span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>



<h4 id="python-直接使用os-system"><a href="#python-直接使用os-system" class="headerlink" title="python 直接使用os.system"></a>python 直接使用os.system</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">command = &#x27;ffmpeg -i ./results/%s/&#x27;%(datasetname[i]) +&#x27;%06d.png ./results&#x27;+&#x27;/%s.mp4&#x27;%(datasetname[i])</span><br><span class="line">print(command)</span><br><span class="line">os.system(command)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/juandx/p/4962089.html">python 读写、创建 文件 - juandx - 博客园</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/01/11/python%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/" data-id="cldvhmuxr0002n7fb8gqa7jex" data-title="python常用指令" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-python超参传递" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/28/python%E8%B6%85%E5%8F%82%E4%BC%A0%E9%80%92/" class="article-date">
  <time class="dt-published" datetime="2022-12-28T07:40:56.000Z" itemprop="datePublished">2022-12-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/28/python%E8%B6%85%E5%8F%82%E4%BC%A0%E9%80%92/">python超参传递</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import argparse</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(&quot;-in&quot;, &quot;--inputA&quot;, help=&quot;this is parameter a&quot;, type=str, default=&quot;&quot;)</span><br><span class="line">parser.add_argument(&quot;-out&quot;, &quot;--outputB&quot;, help=&quot;this is parameter b&quot;,  type=str, default=&quot;&quot;)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line">print(args.inputA)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 /Users/PeppaZhu/Desktop/studio_light/zoom_VB/test_V4_1NGF.py -in test_video_gfdebug/peppa_13test.mov -out peppa_13test_V4_4</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/12/28/python%E8%B6%85%E5%8F%82%E4%BC%A0%E9%80%92/" data-id="clc7ctn850001gofbcgdr4vfu" data-title="python超参传递" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-cplusplus文件管理" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/28/cplusplus%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/" class="article-date">
  <time class="dt-published" datetime="2022-12-28T07:30:21.000Z" itemprop="datePublished">2022-12-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/28/cplusplus%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/">cplusplus文件管理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;filesystem&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line"></span><br><span class="line">namespace fs = std::filesystem;</span><br><span class="line">std::string path = &quot;/Users/oliverzhu/Desktop/test_video/&quot;;</span><br><span class="line">for (const auto &amp;entry : fs::directory_iterator(path))&#123;</span><br><span class="line">        //将文件夹下所有文件名得到</span><br><span class="line">        std::string inputpath = entry.path();</span><br><span class="line">        std::string::size_type nPos1 = std::string::npos;</span><br><span class="line">        std::string::size_type nPos2 = std::string::npos;</span><br><span class="line">        nPos1 = inputpath.find_last_of(&quot;/&quot;);</span><br><span class="line">        nPos2 = inputpath.find_last_of(&quot;.&quot;);</span><br><span class="line">        //截取/开始 长度为nPos2-nPos1-1的字符串</span><br><span class="line">        std::string strPath = inputpath.substr(nPos1 + 1, nPos2-nPos1-1);</span><br><span class="line">        std::string input_path;</span><br><span class="line">        std::string output_path;</span><br><span class="line">        if (nPos2-nPos1 &gt; 1)</span><br><span class="line">        &#123;</span><br><span class="line">            // vaild input path</span><br><span class="line">            input_path = inputpath;</span><br><span class="line">            output_path = &quot;/Users/oliverzhu/Desktop/results/&quot; + strPath + &quot;.mp4&quot;;</span><br><span class="line">            std::cout &lt;&lt; input_path &lt;&lt; std::endl;</span><br><span class="line">            std::cout &lt;&lt; output_path &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://codeantenna.com/a/vhWRDy0wan">https://codeantenna.com/a/vhWRDy0wan</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/12/28/cplusplus%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/" data-id="clc7ctn830000gofb6aep9hva" data-title="cplusplus文件管理" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-cplusplus里数据类型和大小" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/08/cplusplus%E9%87%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%A4%A7%E5%B0%8F/" class="article-date">
  <time class="dt-published" datetime="2022-12-08T07:55:05.000Z" itemprop="datePublished">2022-12-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/08/cplusplus%E9%87%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%A4%A7%E5%B0%8F/">cplusplus里数据类型的大小和存储方式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="不同数据类型的大小"><a href="#不同数据类型的大小" class="headerlink" title="不同数据类型的大小"></a>不同数据类型的大小</h4><p><strong>相同位数的系统下，每一个变量的地址大小相同</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">        int32_t va; int32_t* vb; double vc; double* vd; uint8_t ve; uint8_t* vf; intptr_t vg;</span><br><span class="line"></span><br><span class="line">        int32_t a = sizeof(&amp;va); //8</span><br><span class="line">int32_t b = sizeof(&amp;vb); //8</span><br><span class="line">int32_t d = sizeof(&amp;vc); //8</span><br><span class="line">int32_t e = sizeof(&amp;vd); //8</span><br><span class="line">int32_t f = sizeof(&amp;ve); //8</span><br><span class="line">int32_t g = sizeof(&amp;vf); //8</span><br><span class="line">int32_t h = sizeof(&amp;vg); //8</span><br></pre></td></tr></table></figure>

<p>以上变量地址大小都是 8 ，因为在64位体统下。</p>
<p><strong>相同位数的系统下，不同类型变量占有的空间大小不同</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int32_t va; int32_t* vb; double vc; double* vd; uint8_t ve; uint8_t* vf; intptr_t vg;</span><br><span class="line"></span><br><span class="line">int32_t a = sizeof(va); //4</span><br><span class="line">int32_t b = sizeof(vb); //8</span><br><span class="line">int32_t d = sizeof(vc); //8</span><br><span class="line">int32_t e = sizeof(vd); //8</span><br><span class="line">int32_t f = sizeof(ve); //1</span><br><span class="line">int32_t g = sizeof(vf); //8</span><br><span class="line">int32_t h = sizeof(vg); //8</span><br><span class="line">int32_t i = sizeof(*vb); //4</span><br></pre></td></tr></table></figure>

<p>这里*vb &#x3D;&#x3D; vb[0] </p>
<p><strong>不同位数的系统下，不同&#x2F;相同变量占有的大小不同</strong></p>
<p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/c/32B527F7-37F7-44D0-A4EB-1F35F0AD60C8.jpg"></p>
<p>当申请一块 uint_8* buff 时，系统划分出一个8字节的大小，存储了一个指向随机位置的指针。</p>
<p>buff &#x3D; (uint_8*)calloc(seizeof(*buff) * 10,0 ); 时，buff指向了一块地址。这块地址保存的都是十个 1字节的uint_8数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">        uint8_t* aa;</span><br><span class="line">aa = (uint8_t*)zltCMemoryBasic::zlt_calloc(sizeof(*aa) * bufSizeB * 12, 0);</span><br><span class="line"></span><br><span class="line">        aa[0] = 1; aa[1] = 2;</span><br><span class="line">uint8_t a = aa[0]; //1</span><br><span class="line">uint8_t c = aa[1]; //2</span><br><span class="line">uint8_t b = *aa; //1</span><br><span class="line">uint8_t d = *(aa+1); //2</span><br></pre></td></tr></table></figure>

<h4 id="uint8-int-float-double-怎么在计算机内存储"><a href="#uint8-int-float-double-怎么在计算机内存储" class="headerlink" title="uint8 int float double 怎么在计算机内存储"></a>uint8 int float double 怎么在计算机内存储</h4><p>uint8：占一个字节八位， 无符号数，0～255，算数or逻辑左移右移就是左右移动，舍去移动的位数然后补零</p>
<p>int32 ：四个字节32位，有符号数，最高位代表符号。</p>
<p>最大数2147483647的原码为0111 1111 1111 1111 1111 1111 1111 1111</p>
<p>最小数-2147483648的补码表示为1000 0000 0000 0000 0000 0000 0000 0000，在32位没有原码。</p>
<p>对有符号数逻辑左右移动不考虑符号，算数右移补符号位。</p>
<p>float32: 四字节32位，有符号数，最高位代表符号。E代表指数 2E M代表尾数</p>
<p><img src="/Users/PeppaZhu/Library/Application%20Support/marktext/images/2023-07-18-17-43-16-image.png"></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/84453627">https://zhuanlan.zhihu.com/p/84453627</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/12/08/cplusplus%E9%87%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%A4%A7%E5%B0%8F/" data-id="clbev6o0i0000x1fbhld5hhq8" data-title="cplusplus里数据类型的大小和存储方式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Markdown语法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/06/Markdown%E8%AF%AD%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2022-12-06T08:05:07.000Z" itemprop="datePublished">2022-12-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/06/Markdown%E8%AF%AD%E6%B3%95/">Markdown语法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h4><p><a target="_blank" rel="noopener" href="https://yuleii.github.io/2020/07/03/add-image-in-blog.html">在Jekyll博客中插入图片 - Yulei’s Sandbox</a></p>
<h4 id="插入代码"><a href="#插入代码" class="headerlink" title="插入代码"></a>插入代码</h4><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/65ab196bef04">https://www.jianshu.com/p/65ab196bef04</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/12/06/Markdown%E8%AF%AD%E6%B3%95/" data-id="clbby48hf000039fbb3mjewwr" data-title="Markdown语法" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Markdow/" rel="tag">Markdow</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Shell指令" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/06/Shell%E6%8C%87%E4%BB%A4/" class="article-date">
  <time class="dt-published" datetime="2022-12-06T07:32:55.000Z" itemprop="datePublished">2022-12-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/06/Shell%E6%8C%87%E4%BB%A4/">Shell指令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="语法基础"><a href="#语法基础" class="headerlink" title="语法基础"></a>语法基础</h3><h4 id="作为可执行程序"><a href="#作为可执行程序" class="headerlink" title="作为可执行程序"></a>作为可执行程序</h4><p>将代码保存为name.sh，并 cd 到相应目录</p>
<p>chmod +x .&#x2F;test.sh #使脚本具有执行权限</p>
<p>.&#x2F;test.h 运行，或者将文件拖入终端运行</p>
<p>注意，一定要写成 .&#x2F;test.sh，而不是 test.sh，运行其它二进制的程序也一样，直接写 test.sh，linux 系统会去 PATH 里寻找有没有叫 test.sh 的，而只有 &#x2F;bin, &#x2F;sbin, &#x2F;usr&#x2F;bin，&#x2F;usr&#x2F;sbin 等在 PATH 里，你的当前目录通常不在 PATH 里，所以写成 test.sh 是会找不到命令的，要用 .&#x2F;test.sh 告诉系统说，就在当前目录找。</p>
<p>#! 是一个约定的标记，它告诉系统这个脚本需要什么解释器（sh、bash、php等等）来执行。</p>
<h3 id="使用模版"><a href="#使用模版" class="headerlink" title="使用模版"></a>使用模版</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">echo &quot;Hello World !&quot;</span><br><span class="line">ffmpeg -r 30 -i output/%05d.jpg -vcodec libx264 -vf zscale=matrix=709:r=full output.mp4</span><br><span class="line">mkdir backlit</span><br><span class="line">ffmpeg -i backlit.mp4 -r 30 backlit/%05d.png</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-command-manual.html">https://www.runoob.com/linux/linux-command-manual.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/thatsit/p/shell-jiao-ben-shu-xie-gui-fan.html">Shell脚本书写规范 - That’s_it - 博客园</a></p>
<h4 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">删除文件</span><br><span class="line">rm -r *.pdf</span><br><span class="line">但是一次性删除太多的话就会报错 zsh: argument list too long: rm 此时用</span><br><span class="line">find . -name &quot;*.pdf&quot; -print0 | xargs -0 rm</span><br><span class="line"></span><br><span class="line">移动文件</span><br><span class="line">mv folder2/*.* folder/ </span><br><span class="line">移动太多会报错</span><br><span class="line">find folder2 -name &#x27;*.*&#x27; -exec mv &#123;&#125; folder \;</span><br><span class="line">-exec runs any command, &#123;&#125; inserts the filename found, \; marks the end of the exec command.</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/11289551/argument-list-too-long-error-for-rm-cp-mv-commands">linux - Argument list too long error for rm, cp, mv commands - Stack Overflow</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">查看当前路径下文件个数（不包括下一级子目录里文件个数）</span><br><span class="line">ls -l | grep &quot;^-&quot; | wc -l</span><br><span class="line">查看当前路径下文件个数（包括下一级子目录里文件个数）</span><br><span class="line">ls -lR| grep &quot;^-&quot; | wc -l</span><br><span class="line">查看某目录下文件夹(目录)的个数（包括子目录）</span><br><span class="line">ls -lR | grep &quot;^d&quot; | wc -l</span><br><span class="line"></span><br><span class="line">命令解析：</span><br><span class="line">ls -l</span><br><span class="line">长列表输出该目录下文件信息(注意这里的文件是指目录、链接、设备文件等)，每一行对应一个文件或目录，ls -lR是列出所有文件，包括子目录。</span><br><span class="line"></span><br><span class="line">grep &quot;^-&quot;</span><br><span class="line">过滤ls的输出信息，只保留一般文件，只保留目录是grep &quot;^d&quot;。</span><br><span class="line"></span><br><span class="line">wc -l</span><br><span class="line">统计输出信息的行数，统计结果就是输出信息的行数，一行信息对应一个文件，所以就是文件的个数。</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://noahsnail.com/2017/02/07/2017-02-07-Linux%E7%BB%9F%E8%AE%A1%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E6%95%B0%E7%9B%AE/">Linux统计文件夹下的文件数目 | SnailTyan</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/12/06/Shell%E6%8C%87%E4%BB%A4/" data-id="clbbxftu80000s5fb6jfhei4q" data-title="Shell指令" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Bilateral-and-Guided-Filter" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/02/Bilateral-and-Guided-Filter/" class="article-date">
  <time class="dt-published" datetime="2022-12-02T08:40:39.000Z" itemprop="datePublished">2022-12-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/02/Bilateral-and-Guided-Filter/">Bilateral and Guided Filter</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="双边滤波-for-gray-and-color-images"><a href="#双边滤波-for-gray-and-color-images" class="headerlink" title="双边滤波 for gray and color images"></a>双边滤波 for gray and color images</h3><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>在滤波加权的时候计算几何相似度和光学相似度，在亮度差别大的地方不进行平均加权，从而达到保边。</p>
<p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-02-17-38-26-image.png"></p>
<h4 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h4><p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-02-17-40-06-image.png" alt="test"></p>
<p>在上述公式中，k代表正则化，c(.)代表几何相似度，也就是距离, s(.) 代表光学相似度，可以是色彩的差，亮度的差等。</p>
<h4 id="实验现象"><a href="#实验现象" class="headerlink" title="实验现象"></a>实验现象</h4><p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-02-17-49-40-image.png"></p>
<p>如果只做色彩滤镜相当于对直方图进行压缩，也就是只做色彩滤镜相当于把全图色彩平均，向中灰度压缩。</p>
<p>当像素相似度比较大的时候（100～300），对于小的范围参数影响不大了，因为几乎小范围内的所有数据都在像素相似度内。整图结果主要由范围半径控制。</p>
<p>当范围半径比较大的时候，双边滤波更像是色彩相似度滤镜，表现为对直方图的压缩，现象就是偏灰。</p>
<h4 id="常说到的导致梯度反转"><a href="#常说到的导致梯度反转" class="headerlink" title="常说到的导致梯度反转"></a>常说到的导致梯度反转</h4><p>首先，是双边滤波在做Tone Mapping时才会导致梯度反转。并不是直接用双边滤波得到保边平滑图就会出现梯度反转。</p>
<p>双边滤波在做Tone Mapping时，<em>Fast Bilateral Filtering for the Display of High-Dynamic-Range Images</em> ，将图像分成base层和ditail 层 base &#x3D; BF（ori_img) detail &#x3D; ori_img.&#x2F;base。由于base层在边缘处加权的数据少，所以不稳定，偏向没有边缘的那一侧的值。导致的detail层也不稳定，在增强或者压缩base后，叠加detail会出现梯度反转。</p>
<p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-02-17-57-54-image.png"></p>
<h3 id="Guided-Filter"><a href="#Guided-Filter" class="headerlink" title="Guided Filter"></a>Guided Filter</h3><h4 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h4><p>保边平滑，线性时间复杂度（与滤波半径无关），以及和matting Laplacian matrix理论有相似形式。可以用于：去噪，细节增强&#x2F;平滑，HDR压缩，抠图，羽化，去雾，联合双边上采样。</p>
<h4 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h4><p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-02-18-24-56-image.png"></p>
<p>在一个小的局部区域，输出是guidance I 的一个线性变化，通过这个假设来确保，在局部，输出q的梯度和guidance I的梯度成比例，从而引入，或者说保留guidance I的梯度。</p>
<p><strong>在一个局部的区域内，输出q，或者说是去噪音后的输入p，是引导图I的一个kI+b的线性变化。kI也就是，引导图的变化趋势都被保留，b是为了模拟p所在域的bias。eps控制a不能太大，这项是为了控制平滑（模糊）程度的</strong></p>
<h4 id="公式-1"><a href="#公式-1" class="headerlink" title="公式"></a>公式</h4><p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-02-18-27-36-image.png"></p>
<p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-02-18-27-52-image.png"></p>
<p><img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-02-18-28-09-image.png"></p>
<p>公式意义：</p>
<p>当I没有梯度的时候，a等于0 ；当p没有梯度的时候，a等于0； 也就是<strong>任意一方是平坦图的时候，输出q 退化为p的两次boxfilter</strong></p>
<p>当I有比较大的梯度，p也有比较大梯度，<strong>且他们有相关性的时候（分母一定，也就是I方差一定，Ip相关性越大分子越大），a越大，I的梯度得到保留</strong>；</p>
<p>当引导图的方差远小于eps时，a几乎等于0，像素被平滑，也就是引导图方差相对于eps的关系决定了平滑的力度。</p>
<p><strong>对于引导图I，滤波图p为一副图的情况</strong>，a &#x3D; 方差&#x2F;方差+eps b &#x3D; avg - a*avg。输出就变成了根据方差和eps关系，来选择性输出原图或者是avg图。对于方差比较大的边缘，输出原图的权重高，对于方差比较小的地方，输出平均图的权重高。</p>
<p>公式几何意义：在一个局部区域内，I为横轴p为纵轴，q &#x3D; aI+b，也就是一条直线尽量拟合每一个(I,p) ,那么根据这个拟合结果，可以对原本的p有一个新的输出q。</p>
<img src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-07-13-45-24-image.png" title="" alt="" data-align="inline">

<p>考虑到eps 对a的限制，输出可能更平滑一些</p>
<img title="" src="file:///Users/PeppaZhu/Library/Application%20Support/marktext/images/2023-03-24-16-32-12-image.png" alt="" data-align="inline">

<p>线性复杂度：由于一个固定方框内的均值方差可以采用box filter的优化方式变成线性复杂度，因此本算法也可以优化成线性复杂度。</p>
<h4 id="实验现象-1"><a href="#实验现象-1" class="headerlink" title="实验现象"></a>实验现象</h4><p>参数： GuidedFilter(guided,10,0.000001)，对于引导图是黑白图像，输出会引入边缘处其他梯度，会导致有些边缘模糊。模糊可能是因为，第一，p在该区域不全为0，有梯度变化。引导图在该区域有梯度，a有值，再加上a的平均，导致在边缘区域加入了引导图。第二，引入边缘处的梯度就是不完全的加权加了一部分原图的自然结果。且a并不是1，是-1～11的数据。简单来说，在边缘处黑度图他们不可清晰分类。</p>
<img title="" src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-05-10-31-40-image.png" alt="" width="434">

<p><img title="" src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-05-10-51-46-image.png" alt="" width="198"><img title="" src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-05-10-38-26-image.png" alt="" width="199"><img title="" src="https://github.com/Aacrobat/Aacrobat.github.io/raw/master/img/filter/2022-12-05-10-38-41-image.png" alt="" width="199"></p>
<p>对于引导图是彩色图，其结果好转。彩色图在计算时，a是引导图三通道3*3方差 * （I * P), 也就是单独通道颜色不匹配（哪怕亮度匹配），a依旧很小。防止引入相同亮度不同颜色的边缘信息。简单来说，在rgb色彩空间，边缘可分。</p>
<h4 id="抠图潜在危险"><a href="#抠图潜在危险" class="headerlink" title="抠图潜在危险"></a>抠图潜在危险</h4><ol>
<li><p>半径不能太大。不然线性无法拟合。而且脸部要是有白色高光容易和背景墙混淆。</p>
</li>
<li><p>几乎完全相同颜色的边缘信息会引入。比如白色衣服白色墙体。黑色头发黑色椅子，因为本质上相同颜色不可分。于是会出现更多错误。</p>
</li>
<li><p>边缘处有rgb色彩重叠，会有些错分，带来就是部分引入错误，淡化原本01的强分割边界。</p>
</li>
</ol>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><p><a target="_blank" rel="noopener" href="https://github.com/lisabug/guided-filter">https://github.com/lisabug/guided-filter</a></p>
<h4 id="针对于抠图的潜在危险设计的S-Guided-Filter"><a href="#针对于抠图的潜在危险设计的S-Guided-Filter" class="headerlink" title="针对于抠图的潜在危险设计的S_Guided Filter"></a>针对于抠图的潜在危险设计的S_Guided Filter</h4><p><strong>针对于缺点2</strong>，设计了选择区域的GF，总的来说是颜色差别较大的区域Guided Filter生效，当颜色差别较小的区域不使用Guided Filter</p>
<p>具体做法：在算引导图I 方差的时候，标记I 大于一定值的区域作为生效区域。当引导图为彩色图是，存在RR，RG，RB..等九个协方差，选取最大那个作为判定值。（因为当有一种颜色RR GG BB，或者一对颜色关系RG RB GB 可分时这个区域就可以区分）。</p>
<p>引入的危险：阈值如何计算。太小了的话，那些高噪音的平台区域也变成working area了，太大了的话，一些本来可以使用GF的区域也失效了。</p>
<p>测试case：尽量让浅肤色和白墙，深色头发和黑墙可以区分，不让白衣服白墙，全黑衣服和黑墙，以及高噪音全黑衣服和黑墙引入错误。</p>
<p><strong>针对于缺点3</strong>，对GF后的结果进行了一些拉伸，让分割锐利，且剔除被分到前景的背景，但不在原基础上新增内容（可能有的前景被CNN分到了背景但是GF也无法加回来了）</p>
<p>具体做法：</p>
<p>•Q, Workingarea  &#x3D; GuidedFilter(guidedI,ori_mask) ;&#x2F;&#x2F;得到可分区域或者纹理复杂区域</p>
<p>•Q是GF算法的直接结果，包含错分区域，纹理复杂区域，以及正确区域</p>
<p>•M &#x3D; ori_mask - Q；&#x2F;&#x2F;改变值， M本身在-1～1之间</p>
<p>•M &#x3D; M * 2 – 0.3(beta)；&#x2F;&#x2F;将改变的数据进行拉伸，后在-2.3 ～1.7之间放大改变值的。</p>
<p>•M[M&lt;0]&#x3D; 0;  &#x2F;&#x2F; 1：不会新添加东西 2：如果改变值过小就忽视 。</p>
<p>•M[M&gt;1] &#x3D; 1; &#x2F;&#x2F;数据合理性约束</p>
<p>•Output &#x3D; (Workingarea &#x3D;&#x3D; TRUE)? (ori_mask – M) : ori_mask</p>
<p>•Output &lt; 0 &#x3D; 0; &#x2F;&#x2F; 数据合理性 </p>
<p>引入的危险：*2 - 0.3 是手调拉伸超参数。为了保证变化锐利而非自然。且舍弃了将前景补足的潜力。</p>
<p>测试case：卷曲的头发剔除背景合理，不增加黑头发后面的复杂背景。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/12/02/Bilateral-and-Guided-Filter/" data-id="clbblrwxt0000qtfb98wb8158" data-title="Bilateral and Guided Filter" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algo/" rel="tag">algo</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-卡尔曼滤波" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/17/%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2/" class="article-date">
  <time class="dt-published" datetime="2022-11-17T07:53:56.000Z" itemprop="datePublished">2022-11-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/17/%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2/">卡尔曼滤波</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="卡尔曼滤波"><a href="#卡尔曼滤波" class="headerlink" title="卡尔曼滤波"></a>卡尔曼滤波</h3><h4 id="更通用的，一个变量（状态）的卡尔曼滤波"><a href="#更通用的，一个变量（状态）的卡尔曼滤波" class="headerlink" title="更通用的，一个变量（状态）的卡尔曼滤波"></a>更通用的，一个变量（状态）的卡尔曼滤波</h4><p>就是利用历史数据（根据状态转移方法）预测新数据，并且根据当前观测的新数据值，和其不确定性，综合修正预测的数据。</p>
<h4 id="干了这么"><a href="#干了这么" class="headerlink" title="干了这么"></a>干了这么</h4><p>如果有两个系统对一个数据（高度，位置或者其他的）都有测量或者说是观测，但是都不准。那如何通过这两个不准的东西得到一个更准的结果。</p>
<p>更简单的说法：怎么去求两个数据的加权平均</p>
<p>如何通俗并尽可能详细地解释卡尔曼滤波？ - Kent Zeng的回答 - 知乎 <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/23971601/answer/26254459">https://www.zhihu.com/question/23971601/answer/26254459</a></p>
<h3 id="翻译理解"><a href="#翻译理解" class="headerlink" title="翻译理解"></a>翻译理解</h3><p>接下来按照</p>
<p><a target="_blank" rel="noopener" href="https://www.bzarg.com/p/how-a-kalman-filter-works-in-pictures/">https://www.bzarg.com/p/how-a-kalman-filter-works-in-pictures/</a></p>
<p>一文简单翻译理解一下 这是一个多变量 运动定位系统</p>
<h4 id="what-is-it-？"><a href="#what-is-it-？" class="headerlink" title="what is it ？"></a>what is it ？</h4><p>你有一个不准确但是可以观测的，连续变化的系统。此外，你还能对着干观测值进行一些<strong>科学的</strong>推论。但是也不准。通过卡尔曼滤波（合理的对不准确的推理和不准确的观测结果加权），可以得到一个更准确的当前值的结果。</p>
<h4 id="what-can-we-do-with-a-Kalman-filter"><a href="#what-can-we-do-with-a-Kalman-filter" class="headerlink" title="what can we do with a Kalman filter"></a>what can we do with a Kalman filter</h4><p>假设你有一个小机器人，这个机器人在森林里行走，需要定位。</p>
<p>这个小机器人有一个状态，这个状态包括了当前位置和当前速度。这个速度是某种码表里可以读出来的。此外，这个机器人还有一个GPS定位，表明了当前的位置。不管是GPS还是速度都是不太准的的。怎么得到更准确的当前位置呢？</p>
<h4 id="how-a-Kalman-filter-sees-your-problem"><a href="#how-a-Kalman-filter-sees-your-problem" class="headerlink" title="how a Kalman filter sees your problem"></a>how a Kalman filter sees your problem</h4><p>我们有两个连续变化的数据（假设都服从高斯分布），位置和速度，虽然这些都不准，方差衡量了不同变量各自的不确定性，协方差衡量了他们之间的关系。</p>
<h4 id="Describe-the-problem-with-martics"><a href="#Describe-the-problem-with-martics" class="headerlink" title="Describe the problem with martics"></a>Describe the problem with martics</h4><p>我们可以得到，当前状态的（速度和位置）的均值，然后和这两个变量之间的斜方差矩阵</p>
<p>下一步，我们可以通过p &#x3D; p + vt 得到下一次的位置，速度预测。<strong>这步就是科学推倒得到的合理的预测</strong>。同时更新均值和其斜方差。</p>
<p>此外，考虑再复杂一些，我们加入外力（加速度）和不确定性。</p>
<p>最终影响下一次状态的均值的是，当前状态以及外力，影响下一次斜方差的是当前斜方差，不确定噪音。</p>
<h4 id="Refining-the-estimate-with-measures"><a href="#Refining-the-estimate-with-measures" class="headerlink" title="Refining the estimate with measures"></a>Refining the estimate with measures</h4><p>我们可以通过<strong>直接读数，得到一个位置速度分布的概率</strong>。我们还可以通过<strong>科学推倒得到</strong>一个速度位置分布的概率。那将这两个概率<strong>相乘归一化</strong>，就是更准的概率了。</p>
<h4 id="putting-it-all-together"><a href="#putting-it-all-together" class="headerlink" title="putting it all together"></a>putting it all together</h4><p>新的位置等于 根据老位置预测出来的新位置，以及新位置读数的加权。加权值由推倒公式，读数概率等原始数据共同决定。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/PengWon/article/details/134115339">信号去噪之卡尔曼滤波_卡尔曼滤波 去噪-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/u_16213463/7545080">卡尔曼滤波去噪python_mob64ca12f7e7cf的技术博客_51CTO博客</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1829708">【译】图解卡尔曼滤波(Kalman Filter)-腾讯云开发者社区-腾讯云</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/17/%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2/" data-id="claqkc6790001m1fbbh8f7cty" data-title="卡尔曼滤波" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algo/" rel="tag">algo</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AIGC/" rel="tag">AIGC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMake/" rel="tag">CMake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hydra/" rel="tag">Hydra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdow/" rel="tag">Markdow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Retinex/" rel="tag">Retinex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xcode/" rel="tag">Xcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YUV/" rel="tag">YUV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algo/" rel="tag">algo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/" rel="tag">c++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ffmpeg/" rel="tag">ffmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/" rel="tag">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/software-install/" rel="tag">software_install</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BC%98%E5%8C%96/" rel="tag">优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B1%87%E7%BC%96/" rel="tag">汇编</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8B%E8%AF%95/" rel="tag">测试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AIGC/" style="font-size: 12px;">AIGC</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/CMake/" style="font-size: 10px;">CMake</a> <a href="/tags/Hydra/" style="font-size: 10px;">Hydra</a> <a href="/tags/Markdow/" style="font-size: 10px;">Markdow</a> <a href="/tags/Retinex/" style="font-size: 10px;">Retinex</a> <a href="/tags/Xcode/" style="font-size: 10px;">Xcode</a> <a href="/tags/YUV/" style="font-size: 12px;">YUV</a> <a href="/tags/algo/" style="font-size: 16px;">algo</a> <a href="/tags/c/" style="font-size: 18px;">c++</a> <a href="/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/tags/git/" style="font-size: 16px;">git</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/software-install/" style="font-size: 10px;">software_install</a> <a href="/tags/%E4%BC%98%E5%8C%96/" style="font-size: 12px;">优化</a> <a href="/tags/%E6%B1%87%E7%BC%96/" style="font-size: 14px;">汇编</a> <a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 10px;">测试</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/06/27/YUV-full-vs-limited-601-vs-709/">YUV full vs limited 601 vs 709</a>
          </li>
        
          <li>
            <a href="/2024/06/07/git-merge-vs-rebase/">git merge vs rebase</a>
          </li>
        
          <li>
            <a href="/2023/12/04/Xcode%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/">Xcode使用技巧</a>
          </li>
        
          <li>
            <a href="/2023/11/24/intptr-VS-int32-or-int64/">intptr VS int32 or int64</a>
          </li>
        
          <li>
            <a href="/2023/11/24/CMake-%E7%AE%80%E5%8D%95%E7%94%A8%E6%B3%95/">CMake 简单用法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>